---
- name: add apt repositoriy for firefox
  ansible.builtin.apt_repository:
    repo: ppa:mozillateam/ppa
    state: present
  become: true
  when: "ansible_distribution == 'Ubuntu' and ansible_distribution_major_version >= '22'"

- name: prefer mozillateam PPA in apt preferences
  copy:
    src: files/apt-prefs-mozilla-firefox
    dest: /etc/apt/preferences.d/mozilla-firefox
    mode: '0664'
    owner: root
    group: root
  become: true
  when: "ansible_distribution == 'Ubuntu' and ansible_distribution_major_version >= '22'"

- name: allow firefox updates to be installed automatically from ppa
  copy:
    src: files/unattended-upgrades-firefox
    dest: /etc/apt/apt.conf.d/51unattended-upgrades-firefox
    mode: '0664'
    owner: root
    group: root
  become: true
  when: "ansible_distribution == 'Ubuntu' and ansible_distribution_major_version >= '22'"

- name: install firefox package
  package:
    name: firefox
    state: present
  become: true
  when: "ansible_distribution == 'Ubuntu' and ansible_distribution_major_version >= '22'"